# Putting it all together

## Reflections

In this assignment, I was particularly interested in looking at measures related to substance use, mental health, housing, and poverty rates. I utilized the CDC's PLACES dataset as well as Census Data.

The most notable spatial trend I noticed when I look at all of the maps as a whole is that, on average, our more rural communities are more likely to have higher rates of poverty, substance use, and housing insecurity. It is also evident that Indigenous / Native Montanan communities often see some of the highest rates of these measures.

While none of these insights are new - in fact - the health disparities that we see among both rural communities and Native American populations (in Montana and across the US) have been persistent over decades.

However, this exercise was incredibly helpful for me, and I learned so much by creating this. It was a great way to tie everything together that you have taught us this past semester. I especially appreciated being able to document these processes in this online book, so that I will have a more sustainable reference to turn to for future work and projects.

I plan to continue to build upon this online book, and share it with epidemiologists around the state so that others can practice these skills, too. I know that there are tons of resources just like this out there, but I think my colleagues will appreciate being able to see the material in a very local context that perhaps will speak to them and motivate them more. Other epidemiologists can also help me edit and improve upon the code here which I think is so cool. I'm hopeful and eager to continue to receive feedback and contributions from my colleagues to make this a comprehensive GIS reference tool for many years of epidemiologists and public health professionals to come.

## General Process

Below is a list that gives an overview of my process for this assignment:

-   Brought in Data: CDC PLACES, geographic boundaries for Montana, Census Data

    -   all shapefiles projected to **NAD 83 / Albers Equal Area (EPSG: 32100)**

-   Created custom functions that perform the following tasks:

-   For CDC PLACES data:

    -   national median and standard deviations are calculated for each measure

    -   the difference between each Montana county value and the national median is calculated

    -   differences are categorized into "buckets" based on either a) the number of standard deviations away that value is from the national median, or b) based on a raw percentage difference (this was helpful to use instead when the national standard deviation was particularly high)

    -   custom map legend labels were created based on the categorization

    -   all data were also classified using **Natual Breaks / Jenks** and mapped for comparison

    -   joined data with the county shapefiles

    -   maps created

-   For Census Data:

    -   census data was cleaned and new categories were created that summarized the proportion of the population within each census tract that is living below 150% of the federal poverty level

    -   census data was joined to census tract boundaries

    -   various maps were created, comparing the benefits and drawbacks of each. Specifically, I compared what the maps looked like if we plotted a) unclassified choropleth, b) subset of choropleth highlighting high values c) centroid-based geostatistical point by census tract and d) dorling cartogram

## Final Maps: PLACES Data

::: {layout-nrow=2}
![Smoking](_maps\smoking_ntl_med_plot.png){.lightbox}

![Binge Drinking](_maps\binge_jenks_plot.png){.lightbox}

![Depression](_maps\depression_ntl_med_plot.png){.lightbox} 

![Housing Insecurity](_maps\housing_ntl_med_plot.png){.lightbox}

:::

## Final Maps: Visualizing Poverty Across Census Tracts

### Exploring pros/cons of various ways to show the same data {.unnumbered}

I learned SO much in this class, and there were many lessons learned that will stick with me forever for the better.

Just a few examples include:

-   ‚úÖ I understand much better now that how data is classified and portrayed is subject to the map maker's decision, and therefore, subject to the map maker's own biases.

-   ‚úÖ And further: How we decide to classify the data we are displaying in a choropleth map can **drastically** change the message and the story that is conveyed.

-   ‚úÖ There are so many different ways we can display the same exact underlying data, and they each have their strengths and weaknesses.

-   ‚úÖ Making the decision comes down to honing in on defining our audience, the purpose of the map, and the "take-away" message you want someone to be able to walk away with after viewing the map, all while balancing the act of wanting to highlight particular values or areas without getting carried away or exaggerating the reality so much that it becomes misleading.

Below, I was exploring various ways to display the proportion of people within each census tract of Montana who are living below 150% of the federal poverty level.

-   **Basic choropleth:** this first map does not include any classification or manipulation.

    -   The benefit is that this eliminates my own bias and encodes the "raw" values a bit more accurately.

    -   The biggeset downfall is that census tracts that are simply larger in **area** get emphasized, while smaller census tracts are barely visible.

-   **Subsetting choropleth:** this second map is simply the same exact thing as the first one, except I only highlight the census tracts whose proportion of population living in poverty was 30% or higher. I chose this value because this equates to 2X that of the national median (\~15% of total US population lives below 150% of federal poverty level).

    -   The main purpose of this map was really just to allow myself to more easily and quickly see the spatial spread and locations of where this occurs.

    -   As stated before, the drawback even in this case is that the small census tracts in terms of their areas are very difficult to see.

    -   My goal here is not to accurately represent census tract size. My goal is to convey the quantity and the spatial spread of our poorest communities.

üé¨ **Enter stage right: Geostastical Points and Dorling Cartograms** üé¨

-   **Using geostatistical points:** in the third map, I extracted the center location of each census tract, and then joined it with the federal poverty data. We then size and color each point based on the proportion, where census tracts with higher proportions of their population living in poverty (regardless of their **area**) are drawn out and emphasized.

    -   If our goal was to simply highlight the spatial locations and quantities of census tracts who have a high percentage of those living in poverty, I think this method might be the winner.

Last, but certainly not least ... ü•Å

-   **Dorling Cartogram:** this fourth map I think is very visually appealing and is my favorite for multiple reasons. What the dorling does is very similar to what we did in the third map, but instead of plotting the exact center location of the census tract, it prioritizes **reducing overlap.** Of course, this distorts the location of the census tracts, but its algorithms try their darnedest to preserve the general location. And honestly, I think it does a pretty good job.

    -   Is this helpful though? *Sure, it's pretty, but why would we use this?*

    -   Hands down, the biggest benefit I see with this approach in this case is that, unlike any of the other maps we tried, I can very quickly understand **the proportion** and **the quantity** of census tracts with high levels of poverty without having to look deeper into a data table.

    -   This "take-away" is near impossible to obtain in the first point map, because so many of the census tracts sit very close to each other, and many of the points end up overlapping. Because the larger points stick out, it exaggerates a notion that we have a very high proportion of census tracts with high poverty rates, which is not entirely true.

    -   While it does distort their locations a bit, I can still get a decent sense of where the most burdened communities are located throughout the state.

    -   So, it sort of has the best of both worlds here: it does not emphasize area of census tract over the value it contains (like in choropleths), and it also allows us to see the overall proportion of communities where poverty rates are high (unlike pure centroid-based plots).


::: {layout="[[1,1,1], [1]]"}
![Choropleth: Unclassified](_maps\chor_poverty.png){.lightbox}

![Choropleth Subset: highlights high values](_maps\chor_above30.png){.lightbox}

![Geostatistical Points: centroids from census tracts](_maps\centroid_plot_poverty.png){.lightbox}

![Dorling Cartogram](_maps\dorl_plot_poverty.png){.lightbox}
:::

**The code to create a Dorling Cartogram is surprisingly straightforward, thanks to the `cartogram` package:**

```{r, eval = FALSE}
#| code-fold: true
#| code-summary: "Show the code"

# Create dataset for dorling 
below_dorl_tracts <- below_150_tracts %>%
  filter(!is.na(perc_below150)) 

# generates the "dorling" effect:
dorl <- 
cartogram::cartogram_dorling(
  below_dorl_tracts, 
  weight='perc_below150', 
  k = 1,
  m_weight = 1, 
  itermax = 10)

# Create the dorling cartogram map

dorl_plot <- ggplot() +

# this is the white "feathered" effect you see around the MT boundary:  
as_reference(geom_sf(
              data = MT_boundary, 
              color = "white", 
              fill = NA, 
              linewidth = 2), id = "boundary") + 
with_blur("boundary", sigma = 10) +
  
geom_sf(data = MT_boundary, 
        fill = "#021628") +
  
geom_sf(data = all_counties, 
        fill = "NA", 
        color = alpha("grey", 0.2)) +
  
geom_sf(data = dorl, 
        mapping = aes(geometry=geometry, fill = perc_below150),
        alpha = .90, 
        color=alpha("#021628",0.2)) + 
  
scale_fill_viridis_c() +
labs(title = "Percent of Population Living Below 150% of Federal Poverty Level",
     subtitle = "proportion by census tract in Montana, Dorling cartogram",
     fill = "Percent Living Below 150% FPL") +
  
guides(size = "none") +
theme_void() +
plot_theme$theme



```
